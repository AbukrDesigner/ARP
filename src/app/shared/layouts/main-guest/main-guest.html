<div class="main-guest-layout" [ngClass]="{ 'sidebar-open': sidebarOpen }">
  <div class="main-guest-sidebar-backdrop" (click)="closeSidebar()" [class.visible]="sidebarOpen" aria-hidden="true"></div>
  <aside class="main-guest-sidebar">
    <app-sidebar (navigate)="closeSidebar()"></app-sidebar>
  </aside>

  <div class="main-guest-main">
    <header class="main-guest-header">
      <button
        type="button"
        class="main-guest-sidebar-toggle"
        (click)="toggleSidebar()"
        aria-label="Ouvrir / fermer le menu"
      >
        <i class="bi" [ngClass]="sidebarOpen ? 'bi-x-lg' : 'bi-list'"></i>
      </button>
      <div class="main-guest-header-text">
        <h1 class="mb-1 main-guest-title">{{ pageTitle }}</h1>
        <p class="mb-0 main-guest-subtitle">
          {{ pageSubtitle }}
        </p>
      </div>
      <div class="main-guest-header-actions">
        <!-- <div class="dropdown">
          <button class="btn btn-light btn-md me-2" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
            Nouvelle demande
            <i class="bi bi-chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-center" aria-labelledby="dropdownMenuButton">
            <li><a class="dropdown-item" href="javascript:(0)" (click)="goToDemandeCreate()">Demande de transfert</a></li>
            <li><a class="dropdown-item" href="javascript:(0)">Demande d'attribution de site</a></li>
            <li><a class="dropdown-item" href="javascript:(0)">Demande de variation</a></li>
          </ul>
        </div> -->

        <div class="dropdown" *ngIf="showCreateDemandeButton">
          <button
            class="btn btn-light btn-md me-2"
            type="button"
            (click)="openNewDemandeModal()"
          >
            <i class="bi bi-plus"></i>
            Nouvelle demande
          </button>
          <!-- <ul class="dropdown-menu dropdown-menu-center" aria-labelledby="dropdownMenuButton">
            <li><a class="dropdown-item" href="javascript:(0)" (click)="goToDemandeCreate()">Demande de transfert</a></li>
            <li><a class="dropdown-item" href="javascript:(0)">Demande d'attribution de site</a></li>
            <li><a class="dropdown-item" href="javascript:(0)">Demande de variation</a></li>
          </ul> -->
        </div>
        
        <button
          *ngIf="showCreateSignalementButton"
          type="button"
          class="btn btn-light btn-md me-2"
          (click)="goToSignalementCreate()"
        >
          <i class="bi bi-plus"></i>
          Faire un signalement
        </button>
        <button
          *ngIf="showCreateAmmButton"
          type="button"
          class="btn btn-light btn-md me-2"
          (click)="goToFabricantDemandeCreate()"
        >
          <i class="bi bi-plus"></i>
          Nouvelle demande d'AMM
        </button>
        <button
          *ngIf="showDeclareVariationButton"
          type="button"
          class="btn btn-light btn-md"
          
        >
          <i class="bi bi-plus"></i>
          Déclarer une variation
        </button>
      </div>
    </header>

    <p-dialog
      [(visible)]="displayNewDemandeModal"
      [modal]="true"
      [draggable]="false"
      [resizable]="false"
      [dismissableMask]="true"
      [style]="{ width: '720px', maxWidth: '95vw' }"
      [breakpoints]="{ '960px': '80vw', '640px': '95vw' }"
      contentStyleClass="new-demande-dialog-content"
    >
      <ng-template pTemplate="header">
        <div class="new-demande-header">
          <h2>Quelle Demande Voulez Vous Faire ?</h2>
          <p>Veuillez sélectionnez la demande que vous voulez initier</p>
        </div>
      </ng-template>

      <div class="new-demande-options">
        <button
          type="button"
          class="new-demande-card"
          (click)="onDemandeTransfert()"
          pRipple
        >
          <span class="new-demande-card-title">Demande De Transfert</span>
        </button>

        <button
          type="button"
          class="new-demande-card"
          (click)="onDemandeAttributionSite()"
          pRipple
        >
          <span class="new-demande-card-title">
            Demande D’attribution De Site D’officine
          </span>
        </button>

        <button
          type="button"
          class="new-demande-card"
          (click)="onDemandeVariation()"
          pRipple
        >
          <span class="new-demande-card-title">Demande De Variation</span>
        </button>
      </div>
    </p-dialog>

    <main class="main-guest-content">
      <div class="container-fluid p-0">
        <router-outlet />
      </div>
    </main>
  </div>
</div>
